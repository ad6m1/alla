<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI Creator Console</title>

  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#020617;
      --accent:#22c55e;
      --accent2:#38bdf8;
      --danger:#ef4444;
      --text:#e5e7eb;
      --muted:#94a3b8;
    }

    *{box-sizing:border-box}

    body{
      margin:0;
      min-height:100vh;
      font-family:"Tajawal",system-ui;
      color:var(--text);
      background:
        radial-gradient(600px 300px at 10% 10%,rgba(56,189,248,.15),transparent),
        radial-gradient(500px 300px at 90% 20%,rgba(34,197,94,.12),transparent),
        linear-gradient(180deg,#020617,#020617);
    }

    .app{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:40px 20px;
    }

    .layout{
      width:100%;
      max-width:1100px;
      display:grid;
      grid-template-columns:1fr;
      gap:40px;
    }

    @media(min-width:900px){
      .layout{
        grid-template-columns:1fr 1fr;
        align-items:center;
      }
    }

    .brand h1{
      font-size:38px;
      margin:0 0 12px;
      background:linear-gradient(135deg,#22c55e,#38bdf8);
      -webkit-background-clip:text;
      color:transparent;
    }

    .brand p{
      color:var(--muted);
      max-width:420px;
      line-height:1.7;
    }

    .brand a{
      color:var(--accent2);
      text-decoration:none;
      cursor:pointer;
    }

    .panel{width:100%}

    input,select,textarea{
      width:100%;
      padding:14px;
      border-radius:14px;
      border:1px solid rgba(148,163,184,.2);
      background:#020617;
      color:#fff;
      font-family:inherit;
      margin-bottom:14px;
    }

    textarea{min-height:90px}

    button{
      width:100%;
      padding:14px;
      border:none;
      border-radius:16px;
      font-weight:700;
      cursor:pointer;
      transition:.2s;
    }

    button:active{transform:scale(.96)}

    .btn-main{
      background:linear-gradient(135deg,#22c55e,#4ade80);
      color:#052e16;
    }

    .btn-instagram{
      background:linear-gradient(135deg,#833ab4,#fd1d1d,#fcb045);
      color:#fff;
      margin-top:10px;
    }

    .nav{
      display:flex;
      gap:10px;
      margin-bottom:18px;
    }

    .nav button{
      background:#020617;
      color:#cbd5f5;
    }

    .dots span{
      animation:blink 1.4s infinite both;
    }
    .dots span:nth-child(2){animation-delay:.2s}
    .dots span:nth-child(3){animation-delay:.4s}

    @keyframes blink{
      0%{opacity:.2}
      20%{opacity:1}
      100%{opacity:.2}
    }

    .modal{
      position:fixed;
      inset:0;
      background:rgba(2,6,23,.8);
      display:none;
      align-items:center;
      justify-content:center;
      padding:20px;
    }

    .modal-content{
      background:#020617;
      border:1px solid rgba(148,163,184,.2);
      border-radius:18px;
      max-width:700px;
      padding:24px;
      max-height:80vh;
      overflow:auto;
    }

    .hidden{display:none}
  </style>
</head>

<body>

<div class="app">

  <!-- LOGIN -->
  <div class="layout" id="loginPage">
    <div class="brand">
      <h1>AI Creator Console</h1>
      <p>
        نظام نشر أخطبوطي ذكي يعتمد الأتمتة والذكاء الاصطناعي
        لإدارة ونشر المحتوى عبر منصات التواصل الاجتماعي.
      </p>
      <a onclick="openDisclaimer()">إخلاء المسؤولية</a>
    </div>

    <div class="panel">
      <p>يسمح فقط بإيميلات ahmedmarketing.cloud</p>
      <input id="emailInput" placeholder="name@ahmedmarketing.cloud">
      <input id="codeInput" type="password" placeholder="الرمز">
      <button class="btn-main" onclick="login()">دخول</button>
    </div>
  </div>

  <!-- APP -->
  <div class="layout hidden" id="appPage">

    <div class="brand">
      <h1>Smart Publishing</h1>
      <p>تحكم كامل بعملية النشر، تتبع، وأتمتة بدون تدخل بشري.</p>
    </div>

    <div class="panel">

      <div class="nav">
        <button onclick="go('publish')">النشر</button>
        <button onclick="go('history')">السجل</button>
        <button onclick="logout()" style="background:#ef4444;color:#fff">خروج</button>
      </div>

      <!-- PUBLISH -->
      <div id="publishPage">
        <input type="file" id="mediaInput">

        <select id="postType" onchange="toggleCaption()">
          <option value="">اختر نوع النشر</option>
          <option value="reels">ريلز</option>
          <option value="story">ستوري</option>
          <option value="both">ريلز + ستوري</option>
        </select>

        <textarea id="captionInput" class="hidden" placeholder="الوصف (للريلز فقط)"></textarea>

        <button class="btn-main" onclick="publish()">رفع ونشر</button>
        <div id="statusText"></div>

        <a href="https://www.instagram.com/8jy8/" target="_blank">
          <button class="btn-instagram">الدخول إلى إنستغرام</button>
        </a>
      </div>

      <div id="historyPage" class="hidden"></div>

    </div>
  </div>
</div>

<!-- DISCLAIMER -->
<div class="modal" id="disclaimer">
  <div class="modal-content">
    <h2>إخلاء مسؤولية</h2>
    <p>هذا النظام هو أداة أتمتة ذكية تهدف إلى تسهيل وتسريع عمليات النشر عبر منصات التواصل الاجتماعي.</p>
    <p>لا يتحمل النظام أو مطوّروه أي مسؤولية قانونية أو تقنية ناتجة عن:</p>
    <ul>
      <li>مخالفة سياسات أي منصة تواصل اجتماعي</li>
      <li>استخدام محتوى غير مرخّص أو مخالف</li>
      <li>حظر الحسابات أو تقييدها</li>
    </ul>
    <p>المستخدم هو المسؤول الوحيد عن مراجعة المحتوى والتأكد من توافقه مع سياسات المنصات.</p>
    <button class="btn-main" onclick="closeDisclaimer()">فهمت</button>
  </div>
</div>

<script>
const USERS={
  "admin@ahmedmarketing.cloud":{code:"AM-ADMIN-9007"},
  "ali@ahmedmarketing.cloud":{code:"AM-ALI-7391"},
  "sara@ahmedmarketing.cloud":{code:"AM-SARA-4826"}
};

let currentUserEmail = "";

function login(){
  const email=emailInput.value.trim().toLowerCase();
  const code=codeInput.value.trim();

  if(!USERS[email] || USERS[email].code!==code){
    alert("بيانات غير صحيحة");
    return;
  }

  currentUserEmail = email;

  loginPage.classList.add("hidden");
  appPage.classList.remove("hidden");
  go("publish");
}

function logout(){
  location.reload();
}

function go(page){
  publishPage.classList.add("hidden");
  historyPage.classList.add("hidden");

  if(page==="publish") publishPage.classList.remove("hidden");
  else historyPage.classList.remove("hidden");
}

function toggleCaption(){
  captionInput.classList.toggle(
    "hidden",
    postType.value==="story" || !postType.value
  );
}

async function publish(){
  if(!mediaInput.files.length || !postType.value){
    alert("أكمل البيانات");
    return;
  }

  statusText.innerHTML =
    'قيد النشر <span class="dots"><span>.</span><span>.</span><span>.</span></span>';

  const formData = new FormData();
  formData.append("file", mediaInput.files[0]);
  formData.append("postType", postType.value);
  formData.append("caption", captionInput.value || "");
  formData.append("userEmail", currentUserEmail);

  try{
    const res = await fetch(
      "https://n8n.srv1099752.hstgr.cloud/webhook-test/vip2024",
      {
        method:"POST",
        body:formData
      }
    );

    if(!res.ok) throw new Error("Webhook failed");

    statusText.innerHTML="✅ تم إرسال المحتوى إلى النظام";
  }catch(err){
    statusText.innerHTML="❌ فشل الإرسال إلى النظام";
  }
}

function openDisclaimer(){
  disclaimer.style.display="flex";
}
function closeDisclaimer(){
  disclaimer.style.display="none";
}
</script>

</body>
</html>
